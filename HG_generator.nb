(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     94505,       2205]
NotebookOptionsPosition[     91633,       2147]
NotebookOutlinePosition[     92231,       2167]
CellTagsIndexPosition[     92188,       2164]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["canonical grid generation", "Subsection",
 CellChangeTimes->{
  3.8019912783929996`*^9, {3.815403561343*^9, 3.815403572644*^9}, {
   3.855148617611225*^9, 3.855148621133293*^9}, {3.855148697739156*^9, 
   3.855148698316842*^9}},ExpressionUUID->"fe33b749-774f-42bb-9b63-\
3807fe737bd5"],

Cell[CellGroupData[{

Cell["vector", "Subsubsection",
 CellChangeTimes->{
  3.8019912783929996`*^9, {3.815403561343*^9, 3.815403572644*^9}, {
   3.855148617611225*^9, 3.855148621133293*^9}, {3.855148697739156*^9, 
   3.855148705253515*^9}},ExpressionUUID->"2c7764a2-2e54-45e1-a291-\
d0a16901e0ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SinFunction", "[", 
   RowBox[{"k_", ",", "sA_", ",", "shift_"}], "]"}], ":=", 
  RowBox[{"sA", " ", "bW", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "Pi", " ", "k", " ", "n"}], "+", "shift"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855151667246171*^9, 3.85515166892522*^9}, {
   3.855151778810172*^9, 3.85515178702363*^9}, 
   3.8551522209792123`*^9},ExpressionUUID->"3c9b2551-9859-4812-ad09-\
1522d22cf617"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"1", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sAV", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sSV", "=", 
   RowBox[{"Pi", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sCol", "=", "White"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bCol", "=", "Black"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hOn", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vOn", "=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8551552360087905`*^9, 3.8551552849267015`*^9}},
 CellLabel->
  "In[1299]:=",ExpressionUUID->"675a9eb6-4f05-4589-acea-281b1c4d1e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateGrid", "[", 
   RowBox[{
   "n_", ",", "res_", ",", "r_", ",", "sAV_", ",", "sSV_", ",", "sAH_", ",", 
    "sSH_", ",", "sCol_", ",", "bCol_", ",", "hOn_", ",", "vOn_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sNL", ",", "bNL", ",", "sW", ",", "bW", ",", "sNH", ",", "bNH", ",", 
      "sNV", ",", "bNV", ",", "hCoords", ",", "vCoords", ",", 
      "hWidthComponents", ",", "vWidthComponents", ",", "verticalStreets", 
      ",", "horizontalStreets", ",", "hShift", ",", "vShift", ",", "shrink", 
      ",", "crossings", ",", "gridPoints"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sNL", "=", "0"}], ";", 
     RowBox[{"bNL", "=", "0"}], ";", 
     RowBox[{"sW", "=", 
      FractionBox["r", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], " ", "n"}]]}], ";", 
     RowBox[{"bW", "=", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], " ", "n"}]]}], ";", 
     RowBox[{"sNH", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"UniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "sNL"}], ",", 
           RowBox[{"1", "+", "sNL"}]}], "}"}], "]"}], ",", 
        RowBox[{"n", "+", "1"}]}], "]"}]}], ";", 
     RowBox[{"bNH", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"UniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "bNL"}], ",", 
           RowBox[{"1", "+", "bNL"}]}], "}"}], "]"}], ",", "n"}], "]"}]}], 
     ";", 
     RowBox[{"sNV", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"UniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "sNL"}], ",", 
           RowBox[{"1", "+", "sNL"}]}], "}"}], "]"}], ",", 
        RowBox[{"n", "+", "1"}]}], "]"}]}], ";", 
     RowBox[{"bNV", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"UniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "bNL"}], ",", 
           RowBox[{"1", "+", "bNL"}]}], "}"}], "]"}], ",", "n"}], "]"}]}], 
     ";", 
     RowBox[{"hCoords", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"sW", " ", 
           RowBox[{"Total", "[", 
            RowBox[{"sNH", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
          "+", 
          RowBox[{"bW", " ", 
           RowBox[{"Total", "[", 
            RowBox[{"bNH", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
          "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "sW", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "sNH", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "-", 
             RowBox[{
             "sNH", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}]}]}], 
         RowBox[{
          RowBox[{"sW", " ", 
           RowBox[{"Total", "[", "sNH", "]"}]}], "+", 
          RowBox[{"bW", " ", 
           RowBox[{"Total", "[", "bNH", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "2"], " ", "sW", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "sNH", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "+", 
             RowBox[{
             "sNH", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}], 
            ")"}]}]}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"vCoords", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"sW", " ", 
           RowBox[{"Total", "[", 
            RowBox[{"sNV", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
          "+", 
          RowBox[{"bW", " ", 
           RowBox[{"Total", "[", 
            RowBox[{"bNV", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
          "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "sW", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "sNV", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "-", 
             RowBox[{
             "sNV", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}]}]}], 
         RowBox[{
          RowBox[{"sW", " ", 
           RowBox[{"Total", "[", "sNV", "]"}]}], "+", 
          RowBox[{"bW", " ", 
           RowBox[{"Total", "[", "bNV", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "2"], " ", "sW", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "sNV", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "+", 
             RowBox[{
             "sNV", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}], 
            ")"}]}]}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"hWidthComponents", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sW", " ", 
         RowBox[{
         "sNH", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"vWidthComponents", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sW", " ", 
         RowBox[{
         "sNV", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"verticalStreets", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "hCoords", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "0.5`"}], "}"}]}], "&"}], 
          ")"}], "/@", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#1", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "hCoords", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "0.5`"}], "}"}]}], "&"}], 
           ")"}], "/@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "hCoords", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{"0.5`", " ", 
                  RowBox[{
                  "hWidthComponents", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"SinFunction", "[", 
                  RowBox[{"k", ",", "sAV", ",", "sSV"}], "]"}]}], ",", "k"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", "1", ",", 
                FractionBox["1", "res"]}], "}"}]}], "]"}], ",", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "hCoords", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"0.5`", " ", 
                   RowBox[{
                   "hWidthComponents", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{"SinFunction", "[", 
                   RowBox[{"k", ",", "sAV", ",", "sSV"}], "]"}]}], ",", "k"}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", "1", ",", 
                 FractionBox["1", "res"]}], "}"}]}], "]"}], "]"}]}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"horizontalStreets", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "+", 
            RowBox[{"{", 
             RowBox[{"0.5`", ",", 
              RowBox[{
              "vCoords", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "}"}]}], "&"}], ")"}], "/@", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#1", "-", 
             RowBox[{"{", 
              RowBox[{"0.5`", ",", 
               RowBox[{
               "vCoords", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "}"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{
                 RowBox[{
                 "vCoords", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{"0.5`", " ", 
                  RowBox[{
                  "vWidthComponents", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{"SinFunction", "[", 
                  RowBox[{"k", ",", "sAH", ",", "sSH"}], "]"}]}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", "1", ",", 
                FractionBox["1", "res"]}], "}"}]}], "]"}], ",", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{
                  RowBox[{
                  "vCoords", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"0.5`", " ", 
                   RowBox[{
                   "vWidthComponents", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "-", 
                  RowBox[{"SinFunction", "[", 
                   RowBox[{"k", ",", "sAH", ",", "sSH"}], "]"}]}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", "1", ",", 
                 FractionBox["1", "res"]}], "}"}]}], "]"}], "]"}]}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"hShift", "=", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Max", "[", "horizontalStreets", "]"}], "-", "1", "-", 
         RowBox[{"Abs", "[", 
          RowBox[{"Min", "[", "horizontalStreets", "]"}], "]"}]}], ")"}]}]}], 
     ";", 
     RowBox[{"vShift", "=", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Max", "[", "verticalStreets", "]"}], "-", "1", "-", 
         RowBox[{"Abs", "[", 
          RowBox[{"Min", "[", "verticalStreets", "]"}], "]"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"shrink", "=", 
      FractionBox["1", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", "horizontalStreets", "]"}], "-", 
          RowBox[{"Min", "[", "horizontalStreets", "]"}], "-", "hShift"}], 
         ",", 
         RowBox[{
          RowBox[{"Max", "[", "verticalStreets", "]"}], "-", 
          RowBox[{"Min", "[", "verticalStreets", "]"}], "-", "hShift"}]}], 
        "]"}]]}], ";", 
     RowBox[{"shrink", "=", "1"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"crossings", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[NotEqual]", "1"}], "&&", 
             RowBox[{"j", "\[NotEqual]", "1"}], "&&", 
             RowBox[{"i", "\[NotEqual]", 
              RowBox[{"n", "+", "1"}]}], "&&", 
             RowBox[{"j", "\[NotEqual]", 
              RowBox[{"n", "+", "1"}]}]}], ",", 
            RowBox[{"shrink", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                "hCoords", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "-", "vShift", "-", "0.5`"}], ",", 
               RowBox[{
                RowBox[{
                "vCoords", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "-", "hShift", "-", "0.5`"}]}], 
              "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"gridPoints", "=", 
      RowBox[{"If", "[", 
       RowBox[{"hOn", ",", 
        RowBox[{"If", "[", 
         RowBox[{"vOn", ",", 
          RowBox[{"shrink", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.5`"}], ",", 
                    RowBox[{"-", "0.5`"}]}], "}"}]}], "&"}], ")"}], "/@", 
                 "#1"}], "&"}], ")"}], "/@", 
              RowBox[{"(", 
               RowBox[{"horizontalStreets", "-", "hShift"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.5`"}], ",", 
                    RowBox[{"-", "0.5`"}]}], "}"}]}], "&"}], ")"}], "/@", 
                 "#1"}], "&"}], ")"}], "/@", 
              RowBox[{"(", 
               RowBox[{"verticalStreets", "-", "vShift"}], ")"}]}]}], "]"}]}],
           ",", 
          RowBox[{"shrink", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.5`"}], ",", 
                    RowBox[{"-", "0.5`"}]}], "}"}]}], "&"}], ")"}], "/@", 
               "#1"}], "&"}], ")"}], "/@", 
            RowBox[{"(", 
             RowBox[{"horizontalStreets", "-", "hShift"}], ")"}]}]}]}], "]"}],
         ",", 
        RowBox[{"If", "[", 
         RowBox[{"vOn", ",", 
          RowBox[{"shrink", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.5`"}], ",", 
                    RowBox[{"-", "0.5`"}]}], "}"}]}], "&"}], ")"}], "/@", 
               "#1"}], "&"}], ")"}], "/@", 
            RowBox[{"(", 
             RowBox[{"verticalStreets", "-", "vShift"}], ")"}]}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"bCol", ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.6"}], ",", 
             RowBox[{"-", "0.6"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.6", ",", "0.6"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "sCol", ",", 
         RowBox[{"Polygon", "/@", "gridPoints"}]}], "\[IndentingNewLine]", 
        "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.815410724561*^9, 3.815410725585*^9}, {3.815417962201*^9,
    3.815417962725*^9}, {3.815418121958*^9, 3.815418145363*^9}, 
   3.815419933074*^9, {3.815419997092*^9, 3.815419999009*^9}, {
   3.815420200658*^9, 3.81542020117*^9}, {3.8154204361470003`*^9, 
   3.815420440001*^9}, {3.8154230680620003`*^9, 3.815423070414*^9}, {
   3.815510234631*^9, 3.815510237402*^9}, {3.815510347561*^9, 
   3.81551034933*^9}, {3.815510535638*^9, 3.815510538578*^9}, {
   3.8155106003199997`*^9, 3.815510602517*^9}, {3.815510634678*^9, 
   3.815510637278*^9}, {3.815511878959*^9, 3.815511899269*^9}, {
   3.855150178214777*^9, 3.855150191760243*^9}, {3.8551502221392775`*^9, 
   3.855150223362363*^9}, {3.8551506570022984`*^9, 3.855150657077812*^9}, {
   3.855151529725726*^9, 3.855151551240553*^9}, {3.8551515943932943`*^9, 
   3.855151606654056*^9}, {3.8551516803175554`*^9, 3.8551517607917185`*^9}, {
   3.8551517910440273`*^9, 3.855151850175249*^9}, {3.855151883730839*^9, 
   3.8551518964650354`*^9}, {3.8551519654806814`*^9, 3.855152022029399*^9}, {
   3.855152070857179*^9, 3.855152130155209*^9}, {3.8551522027449875`*^9, 
   3.855152240997352*^9}, {3.8551523167419176`*^9, 3.8551523386045675`*^9}, {
   3.8551524170644383`*^9, 3.855152556632865*^9}, {3.855153026782181*^9, 
   3.855153027312235*^9}, {3.85515306503306*^9, 3.8551531235715933`*^9}, {
   3.8551531582219734`*^9, 3.8551533157340508`*^9}, {3.855153531459482*^9, 
   3.8551535338475275`*^9}, {3.855153637995352*^9, 3.855153652546006*^9}, {
   3.8551537391247115`*^9, 3.855153815741078*^9}, {3.855153893751964*^9, 
   3.855153914253371*^9}, {3.8551542389037704`*^9, 3.8551542644165535`*^9}, {
   3.855154830204873*^9, 3.855154875624696*^9}, {3.855154991484206*^9, 
   3.855155016811287*^9}, {3.8551550593893986`*^9, 3.8551551399064407`*^9}, {
   3.855155207422991*^9, 3.8551552259573174`*^9}, {3.8551553377486706`*^9, 
   3.8551554424319987`*^9}, {3.855157858464095*^9, 3.8551578715032234`*^9}, 
   3.855158004453351*^9},
 CellLabel->
  "In[1408]:=",ExpressionUUID->"d4f88b7e-b83d-47be-a3d0-7a3bffe5ce87"]
}, Open  ]],

Cell[CellGroupData[{

Cell["raster", "Subsubsection",
 CellChangeTimes->{
  3.8019912783929996`*^9, {3.815403561343*^9, 3.815403572644*^9}, {
   3.815737609834*^9, 3.815737614551*^9}, {3.8551487109787645`*^9, 
   3.855148712306881*^9}},ExpressionUUID->"4fe25e58-6696-4aa0-b544-\
b4009937a4da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MinPos", "[", "list_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{"list", ",", 
      RowBox[{"Min", "[", "list", "]"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistFunction", "[", "pos_", "]"}], ":=", 
  RowBox[{"Min", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{"pos", ",", "#"}], "]"}], "&"}], ",", "pixelCoords"}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"IllusionFunction", "[", 
   RowBox[{"d_", ",", "hsp_", ",", "ab_", ",", "min_", ",", "max_"}], "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{"G", "[", 
    RowBox[{"d", ",", "hsp", ",", "ab", ",", "min", ",", "max"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"d_", ",", "hsp_", ",", "ab_"}], "]"}], ":=", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Exp", "[", " ", 
      RowBox[{"ab", 
       RowBox[{"(", 
        RowBox[{"d", "-", " ", "hsp"}], ")"}]}], "]"}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"G", "[", 
   RowBox[{"d_", ",", "hsp_", ",", "ab_", ",", "min_", ",", "max_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"d", ",", "hsp", ",", "ab"}], "]"}], "-", 
      RowBox[{"F", "[", 
       RowBox[{"1", ",", "hsp", ",", "ab"}], "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"max", "-", "min"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"0", ",", "hsp", ",", "ab"}], "]"}], "-", 
       RowBox[{"F", "[", 
        RowBox[{"1", ",", "hsp", ",", "ab"}], "]"}]}], ")"}]}]}], "+", 
   "min"}]}], "\n", 
 RowBox[{
  RowBox[{"G2", "[", 
   RowBox[{"F_", ",", "dist_", ",", "min_", ",", "max_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "[", "dist", "]"}], "-", 
      RowBox[{"F", "[", "1", "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"max", "-", "min"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "0", "]"}], "-", 
       RowBox[{"F", "[", "1", "]"}]}], ")"}]}]}], "+", "min"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8238382404849997`*^9, 3.8238382654960003`*^9}, {
  3.8551505182226906`*^9, 3.8551505427743554`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"d9bf4506-c9e0-4701-aa7b-e613d25043b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sW", "//", "N"}]], "Input",
 CellChangeTimes->{{3.823839641637*^9, 3.8238396505290003`*^9}},
 CellLabel->"In[869]:="],

Cell[BoxData["0.047619047619047616`"], "Output",
 CellChangeTimes->{{3.82383964699*^9, 3.823839650916*^9}},
 CellLabel->"Out[869]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"1", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"approxSize", "=", "200"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hsp", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ab", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"min", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"max", "=", "0.15"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bW", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"n", "+", "r", "+", 
      RowBox[{"n", " ", "r"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sW", "=", 
   RowBox[{"r", " ", "bW"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coords", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"0.5", "sW"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"sW", "+", "bW"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"possibleSizes", "=", 
    RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "1"}], ")"}], 
             RowBox[{"Round", "[", 
              RowBox[{"sW", " ", "pixelSize"}], "]"}]}], "+", 
            RowBox[{"n", " ", 
             RowBox[{"Round", "[", 
              RowBox[{"bW", " ", "pixelSize"}], "]"}]}]}], "\[Equal]", 
           "pixelSize"}], ",", "pixelSize"}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"pixelSize", ",", 
          RowBox[{"approxSize", "-", 
           RowBox[{"2", "n"}]}], ",", 
          RowBox[{"approxSize", "+", 
           RowBox[{"2", "n"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", ",",
       "Null"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pixelSize", "=", 
    RowBox[{"possibleSizes", "[", 
     RowBox[{"[", 
      RowBox[{"MinPos", "[", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"approxSize", "-", "#"}], "]"}], "&"}], ",", 
         "\[IndentingNewLine]", "possibleSizes"}], "\[IndentingNewLine]", 
        "]"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pixelCoords", " ", "=", 
    RowBox[{"Flatten", "[", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", "3"}], "&&", 
             RowBox[{"j", "\[Equal]", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "100"}], ",", 
              RowBox[{"-", "100"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "pixelSize"}], ",", 
                "0.5"}], "]"}], ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], " ", "pixelSize"}], ",", 
                "0.5"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxPossibleDistance", "=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"pixelSize", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sW", "+", "bW"}], ")"}], "/", "2"}]}], ",", "2"}], 
       "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gridMatrix1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"i", " ", "pixelSize"}], "-", "0.5", "-", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "pixelSize"}]}], 
                  "]"}], "<", 
                 RowBox[{"pixelSize", " ", 
                  RowBox[{"sW", "/", "2"}]}]}], ",", "1", ",", "0"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], 
            "]"}], "\[Equal]", "1"}], " ", "||", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"j", " ", "pixelSize"}], "-", "0.5", "-", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "pixelSize"}]}], 
                  "]"}], "<", 
                 RowBox[{"pixelSize", " ", 
                  RowBox[{"sW", "/", "2"}]}]}], ",", "1", ",", "0"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], 
            "]"}], "\[Equal]", "1"}]}], " ", ",", "\[IndentingNewLine]", "1", 
         ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"1", "/", "pixelSize"}], ",", "1", ",", 
         RowBox[{"1", "/", "pixelSize"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"1", "/", "pixelSize"}], ",", "1", ",", 
       RowBox[{"1", "/", "pixelSize"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridMatrix2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"i", " ", "pixelSize"}], "-", "0.5", "-", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "pixelSize"}]}], 
                   "]"}], "<", 
                  RowBox[{"pixelSize", " ", 
                   RowBox[{"sW", "/", "2"}]}]}], ",", "1", ",", "0"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], 
             "]"}], "\[Equal]", "1"}], " ", "||", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"j", " ", "pixelSize"}], "-", "0.5", "-", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "pixelSize"}]}], 
                   "]"}], "<", 
                  RowBox[{"pixelSize", " ", 
                   RowBox[{"sW", "/", "2"}]}]}], ",", "1", ",", "0"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], 
             "]"}], "\[Equal]", "1"}]}], " ", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"DistFunction", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", " ", "pixelSize"}], "-", "0.5"}], ",", 
                RowBox[{
                 RowBox[{"j", " ", "pixelSize"}], "-", "0.5"}]}], "}"}], 
              "]"}], "\[LessEqual]", "maxPossibleDistance"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"DistFunction", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", " ", "pixelSize"}], "-", "0.5"}], ",", 
                  RowBox[{
                   RowBox[{"j", " ", "pixelSize"}], "-", "0.5"}]}], "}"}], 
                "]"}], "\[LessEqual]", " ", 
               RowBox[{"sW", " ", "pixelSize", " ", "0.5", " ", "10"}]}], " ",
               ",", "\[IndentingNewLine]", 
              RowBox[{"IllusionFunction", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"DistFunction", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", " ", "pixelSize"}], "-", "0.5"}], ",", 
                    RowBox[{
                    RowBox[{"j", " ", "pixelSize"}], "-", "0.5"}]}], "}"}], 
                  "]"}], "/", "maxPossibleDistance"}], ",", 
                "\[IndentingNewLine]", "hsp", ",", "\[IndentingNewLine]", 
                "ab", ",", "\[IndentingNewLine]", "min", ",", 
                "\[IndentingNewLine]", "max"}], "\[IndentingNewLine]", "]"}], 
              ",", "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}],
             ",", "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"1", "/", "pixelSize"}], ",", "1", ",", 
          RowBox[{"1", "/", "pixelSize"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"1", "/", "pixelSize"}], ",", "1", ",", 
        RowBox[{"1", "/", "pixelSize"}]}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imSize", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gridImage", "=", 
  RowBox[{"Row", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Image", "[", 
      RowBox[{"gridMatrix1", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"imSize", ",", "imSize"}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IllusionFunction", "[", 
        RowBox[{"d", ",", "hsp", ",", "ab", ",", "min", ",", "max"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Thick"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Cambria\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<brightness\>\"", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<absolute distance from crossing (pixels)\>\"", ",", 
            "\"\<relative distance from crossing\>\""}], "}"}]}], "}"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"i", " ", "maxPossibleDistance"}], ",", "3"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", "0.2"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "1", ",", "0.2"}], "}"}]}], 
             "]"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Black", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Cambria\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"\"\<hsp = \>\"", "<>", 
             RowBox[{"ToString", "[", "hsp", "]"}], "<>", "\"\<\\nab = \>\"", 
             "<>", 
             RowBox[{"ToString", "[", "ab", "]"}], "<>", "\"\<\\nmax' = \>\"",
              "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"1", "-", "min"}], "]"}], "<>", "\"\<\\nmin' = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"1", "-", "max"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0.75", ",", "0.3"}], "}"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "1", ",", "1", ",", "0.8"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.98", ",", "0.8"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
           RowBox[{"FontSize", "\[Rule]", "60"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
            "\"\<\!\(TraditionalForm\`r \[LessEqual] \*FractionBox[\(sW\), \
\(2\)]\)\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0.55", ",", "0.5"}], "}"}]}], "]"}]}], "*)"}], "}"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"imSize", ",", "imSize"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Image", "[", 
      RowBox[{"gridMatrix2", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"imSize", ",", "imSize"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.815763194093*^9, 3.815763268784*^9}, {3.815763382718*^9,
    3.815763387684*^9}, {3.815763424671*^9, 3.8157636314370003`*^9}, {
   3.81576369106*^9, 3.815763691902*^9}, {3.815763729744*^9, 
   3.8157637380360003`*^9}, {3.815763769409*^9, 3.815763801266*^9}, {
   3.815763835278*^9, 3.815763900126*^9}, 3.815763971053*^9, {
   3.8157640097460003`*^9, 3.815764051459*^9}, {3.81576408242*^9, 
   3.815764085307*^9}, {3.815764123726*^9, 3.815764123822*^9}, {
   3.815765875965*^9, 3.815765897072*^9}, {3.81576595987*^9, 
   3.8157660127320004`*^9}, {3.8157661121610003`*^9, 3.815766138234*^9}, {
   3.815766170784*^9, 3.815766199935*^9}, {3.8157663541400003`*^9, 
   3.8157663628900003`*^9}, {3.81576649656*^9, 3.815766513495*^9}, {
   3.8157666617539997`*^9, 3.815766667512*^9}, {3.815766794968*^9, 
   3.8157668074110003`*^9}, {3.815767401852*^9, 3.815767504966*^9}, {
   3.8157679530950003`*^9, 3.8157679852390003`*^9}, {3.815768035035*^9, 
   3.8157680482139997`*^9}, {3.815768088276*^9, 3.8157681456070004`*^9}, {
   3.815768187561*^9, 3.815768223686*^9}, {3.815768383302*^9, 
   3.815768389781*^9}, {3.815768814644*^9, 3.815768906676*^9}, {
   3.815768943833*^9, 3.8157689737320004`*^9}, {3.8157690099449997`*^9, 
   3.815769082061*^9}, {3.815769129689*^9, 3.8157691642019997`*^9}, {
   3.815770151941*^9, 3.815770199509*^9}, {3.815770235699*^9, 
   3.815770251047*^9}, {3.815771291507*^9, 3.815771291745*^9}, {
   3.815772745841*^9, 3.815772749918*^9}, {3.815773643427*^9, 
   3.8157736469440002`*^9}, {3.815773947064*^9, 3.815773963598*^9}, {
   3.81577408855*^9, 3.8157741144960003`*^9}, {3.815775218523*^9, 
   3.815775256196*^9}, {3.815775299082*^9, 3.8157754560109997`*^9}, {
   3.815775981369*^9, 3.815776468093*^9}, {3.815776507947*^9, 
   3.8157765293199997`*^9}, {3.815776617132*^9, 3.815776667703*^9}, {
   3.8157768352720003`*^9, 3.815776848263*^9}, {3.815776887*^9, 
   3.815776919176*^9}, {3.8157769581029997`*^9, 3.8157771262*^9}, {
   3.815777191208*^9, 3.815777196585*^9}, {3.815777918392*^9, 
   3.815777923318*^9}, {3.815802734599*^9, 3.815802763998*^9}, {
   3.815802832801*^9, 3.815802857585*^9}, {3.81580291296*^9, 
   3.815802934127*^9}, {3.8158029667390003`*^9, 3.8158029866219997`*^9}, 
   3.815803021248*^9, {3.815803106256*^9, 3.81580319446*^9}, {
   3.8158032453929996`*^9, 3.8158032600109997`*^9}, {3.815803291315*^9, 
   3.815803292045*^9}, {3.815803327824*^9, 3.8158034145889997`*^9}, {
   3.815803475182*^9, 3.815803476551*^9}, 3.8158035174890003`*^9, {
   3.81580356592*^9, 3.8158036814379997`*^9}, {3.815803712257*^9, 
   3.815803796203*^9}, {3.815803834977*^9, 3.815803968832*^9}, {
   3.815804006507*^9, 3.815804013487*^9}, {3.815804050677*^9, 
   3.815804117436*^9}, {3.815804294014*^9, 3.815804294061*^9}, {
   3.815804453519*^9, 3.815804474906*^9}, {3.815804563973*^9, 
   3.8158045640620003`*^9}, {3.815806028099*^9, 3.815806047008*^9}, {
   3.81580608481*^9, 3.815806117374*^9}, {3.8551526303722887`*^9, 
   3.855152631811367*^9}},
 CellLabel->
  "In[1034]:=",ExpressionUUID->"6d064f03-63bb-47e8-b70b-e8e9e85dbb43"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[
    TagBox[
     RasterBox[CompressedData["
1:eJzt2DFKA1EYRtGHhWQbbkEXINlCXMEIWgUCsRA79+emNGjva3xc4QzcgWGK
89X/zePp8Hw1xnjZfb0O2+v+fN7eHq4vH0/b8e72ePn58dMY7/eSJEmSJEmS
JP3eXzw83n/1Slt4vLJX2sLjlb3SFh6v7JW28Hhlr7SFxyt7pS08XtkrbeHx
yl5pC49X9kpbeLyyV9rC45W90hYer+yVtvB4Za+0hccre6UtPF7ZK23h8cpe
aQuPV/ZKW3i8slfawuOVvdIWHq/slbbweGVPkiRJkiRJkqSZVt+vebyyV9rC
45W90hYer+yVtvB4Za+0hccre6UtPF7ZK23h8cpeaQuPV/ZKW3i8slfawuOV
vdIWHq/slbbweGWvtIXHK3ulLTxe2Stt4fHKXmkLj1f2Slt4vLJX2sLjlb3S
Fh6v7JW28Hhlr7SFxyt7kiRJkiRJkiTNtPp+zeOVvdIWHq/slbbweGWvtIXH
K3ulLTxe2Stt4fHKXmkLj1f2Slt4vLJX2sLjlb3SFh6v7JW28Hhlr7SFxyt7
pS08XtkrbeHxyl5pC49X9kpbeLyyV9rC45W90hYer+yVtvB4Za+0hccre6Ut
PF7ZkyRJkiRJkiRpptX3ax6v7JW28Hhlr7SFxyt7pS08XtkrbeHxyl5pC49X
9kpbeLyyV9rC45W90hYer+yVtvB4Za+0hccre6UtPF7ZK23h8cpeaQuPV/ZK
W3i8slfawuOVvdIWHq/slbbweGWvtIXHK3ulLTxe2Stt4fHKniRJkiRJkiRJ
M62+X/N4Za+0hccre6UtPF7ZK23h8cpeaQuPV/ZKW3i8slfawuOVvdIWHq/s
lbbweGWvtIXHK3ulLTxe2Stt4fHKXmkLj1f2Slt4vLJX2sLjlb3SFh6v7JW2
8Hhlr7SFxyt7pS08XtkrbeHxyl5pC49X9iRJkiRJkiRJmmn1/ZrHK3ulLTxe
2Stt4fHKXmkLj1f2Slt4vLJX2sLjlb3SFh6v7JW28Hhlr7SFxyt7pS08Xtkr
beHxyl5pC49X9kpbeLyyV9rC45W90hYer+yVtvB4Za+0hccre6UtPF7ZK23h
8cpeaQuPV/ZKW3i8sidJkiRJkiRJ0kyr79c8XtkrbeHxyl5pC49X9kpbeLyy
V9rC45W90hYer+yVtvB4Za+0hccre6UtPF7ZK23h8cpeaQuPV/ZKW3i8slfa
wuOVvdIWHq/slbbweGWvtIXHK3ulLTxe2Stt4fHKXmkLj1f2Slt4vLJX2sLj
lT1JkiRJkiRJkr77BEQlLF4=
      "], {{0, 203.}, {203., 0}}, {0., 1.}, ColorFunction -> GrayLevel], 
     BoxForm`ImageTag[
     "Real32", ColorSpace -> Automatic, Interleaving -> None], Selectable -> 
     False], DefaultBaseStyle -> "ImageGraphics", 
    ImageSizeRaw -> {203., 203.}, PlotRange -> {{0, 203.}, {0, 203.}}, 
    ImageSize -> {300, 300}], 
   GraphicsBox[{{{{}, {}, 
       TagBox[{
         Directive[
          Opacity[1.], 
          AbsoluteThickness[1.6], 
          GrayLevel[0], 
          Thickness[Large]], 
         LineBox[CompressedData["
1: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
9Jeno//9TjeWsJ9LCU7hJyru//4fywdT4Q==
          "]]}, Annotation[#, "Charting`Private`Tag$9338#1"]& ]}}, {}}, {
    DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
     AxesOrigin -> {0, 0}, FrameTicks -> {{Automatic, {}}, {{{0., 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"0.\"", ShowStringCharacters -> False], 0., 
             AutoDelete -> True], NumberForm[#, 3]& ], TraditionalForm]}, {
         0.2, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"3.96\"", ShowStringCharacters -> False], 
             3.9597979746446668`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {0.4, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"7.92\"", ShowStringCharacters -> False], 
             7.9195959492893335`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {0.6000000000000001, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"11.9\"", ShowStringCharacters -> False], 
             11.879393923934002`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {0.8, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"15.8\"", ShowStringCharacters -> False], 
             15.839191898578667`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {1., 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"19.8\"", ShowStringCharacters -> False], 
             19.79898987322333, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}}, {{0., 
          FormBox["0.`", TraditionalForm]}, {0.2, 
          FormBox["0.2`", TraditionalForm]}, {0.4, 
          FormBox["0.4`", TraditionalForm]}, {0.6000000000000001, 
          FormBox["0.6000000000000001`", TraditionalForm]}, {0.8, 
          FormBox["0.8`", TraditionalForm]}, {1., 
          FormBox["1.`", TraditionalForm]}}}}, GridLines -> {None, None}, 
     DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     PlotRangeClipping -> True, ImagePadding -> All, DisplayFunction -> 
     Identity, AspectRatio -> 1, Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Epilog -> {
       GrayLevel[0], FontFamily -> "Cambria", FontSize -> 20, 
       InsetBox[
        FormBox[
        "\"hsp = 0.125\\nab = 20\\nmax' = 1\\nmin' = 0.85\"", 
         TraditionalForm], {0.75, 0.3}]}, 
     Frame -> {{True, False}, {True, True}}, FrameLabel -> {{
        FormBox["\"brightness\"", TraditionalForm], None}, {
        FormBox[
        "\"absolute distance from crossing (pixels)\"", TraditionalForm], 
        FormBox["\"relative distance from crossing\"", TraditionalForm]}}, 
     FrameTicks -> {{Automatic, None}, {{{0., 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"0.\"", ShowStringCharacters -> False], 0., 
             AutoDelete -> True], NumberForm[#, 3]& ], TraditionalForm]}, {
         0.2, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"3.96\"", ShowStringCharacters -> False], 
             3.9597979746446668`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {0.4, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"7.92\"", ShowStringCharacters -> False], 
             7.9195959492893335`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {0.6000000000000001, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"11.9\"", ShowStringCharacters -> False], 
             11.879393923934002`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {0.8, 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"15.8\"", ShowStringCharacters -> False], 
             15.839191898578667`, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}, {1., 
          FormBox[
           TagBox[
            InterpretationBox[
             StyleBox["\"19.8\"", ShowStringCharacters -> False], 
             19.79898987322333, AutoDelete -> True], NumberForm[#, 3]& ], 
           TraditionalForm]}}, {{0., 
          FormBox["0.`", TraditionalForm]}, {0.2, 
          FormBox["0.2`", TraditionalForm]}, {0.4, 
          FormBox["0.4`", TraditionalForm]}, {0.6000000000000001, 
          FormBox["0.6000000000000001`", TraditionalForm]}, {0.8, 
          FormBox["0.8`", TraditionalForm]}, {1., 
          FormBox["1.`", TraditionalForm]}}}}, GridLines -> {None, None}, 
     GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> {300, 300}, LabelStyle -> {
       GrayLevel[0], FontFamily -> "Cambria", FontSize -> 14}, 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None,
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotRange -> {{0, 1}, {0, 1}}, 
     PlotRangeClipping -> True, 
     PlotRangePadding -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     Ticks -> {Automatic, Automatic}}], 
   GraphicsBox[
    TagBox[
     RasterBox[CompressedData["
1:eJzt3T2IXGUYxfHFQlJYqPhRSUgholhpYSHyonWqBAsthDWYWMQokaBRs9ci
lWUU1Ag2IhYiWIiFRcBCCAgWK4ikshESU4REYZfVbJxn9xYpMuzOcmfvOSf/
C4+TOzszv7kwZz7e+76P+15+/cDhOxYWFt7cM/nPgcW3nj1+fPHkwTtr55XF
o08+cbT++HNfCwvvN4qiKIqiKIqiKIqiKIqiKIrauuax4eG5ekrPBQ9P2VN6
Lnh4yp7Sc8HDU/aUngsenrKn9Fzw8JQ9peeCh6fs7e5zuXGja9MKD29sTykr
65NjvH6LWp/TsePhzbbpZGVtcoyrfa3c9O+1OR07Ht5sm05WrkyO8fKkLk3q
Yn9Z+1fmdOx4eLNtOllZnhzj+Un9OKlz/WXtL8/p2PHwZtt0snJ6coxHJnVw
Uvv7y9o/Padjx8ObbdPJyvfrXTs0qUcmdU9/Wft1PR7e2J5SVj75r2tf/du1
v9e69u3a5mXt1/V4eGN7Slm5f6VrB/7p2lPXuvba1c3L2q/r8fDG9pSy8tfF
rv32R9e6C1279/fNy9qv6/HwxvaUsvLMT1377puufXC2a3d/uHlZ+3U9Ht7Y
nlJWnj7Wtc8f69oDV5faQxeWNi5rv67HwxvbU8rK418utV8unWpnnjvV9q6/
t3FZ+3U9Ht7YnlJW6nhP7H23fXHoZLvv67c3Lmu/rsfDG9vbeVamV83zrPlr
a/18g+X+/FCNe9d4Xo1T1O+v+l5Zn5f1PlDHt7TnnXbm2on28KPH26+fvbFx
Wft1ff29ble3r/vV/etx6vHqcU/3Dh7erN5a/3rdnJ88fB62ykrN91zt5+ec
78+n1nmiGv+ucb0ar6jfYfX9sj436/2gjnPfn8fa5R9ebR89f3jjsvbr+vp7
3a5uX/er+9fj1OPV4x7pHTy8Wb3V/vU6dlYu9fN0av5BnVet80U1Dl7jezVu
Ub/H6ntmfX7W+0Id78d3LbYXH3xp47L26/r6e92ubl/3q/vX49Tj1eMe7B08
vFk9hazUPOma/3mun69T8xDq/GqdN6rx8Brnq/GL+rys75v1OVrvD3XcZz99
YeOy9uv6+nvdrm5f96v71+PU49Xj7u8dPLxZvRWBrPC5gufgKXyu8HsFz8Eb
OyuMg+G5ePMfBxt+Sx+fx/P2lLKSft4Xz9tTykr6fCI8b08pK+nzVPG8PaWs
pK9/wPP2lLKSvq4Oz9tTykr6em08b08pK+l9QPC8PaWspPeXwvP2lLKS3rcQ
z9tTykp6P1w8b08pK7v9PrHbfdbT33fTPaWs7Pb3z93+/3ekf59P95Systvj
Grv9/4VKHydK95SyojVePvyWfv4h3VPKitZ52OG39PPa6Z5SVrTm9wy/pc+X
SveUsqI1b3T4LX0ebrqnlBWt9QjDb+nrO9I9paxorXMbfktfN5juKWVFa/30
8Fv6evR0b+dZmV5j93GZd1+OsY8Pz+v1stVracz+YPPu9zT28eF5vV62+1pK
7CM49vHheb1etvNaGquf8bz70459fHherxfl910+V/CUXi/bfS0lfv8c+/jw
vF4vW72WGAfLGSdK9+hnvJ0t+/jwht50sqJ1Hnb4Lf28drqnlBWt+T3Db+nz
pdI9paxozRsdfkufh5vuKWVFaz3C8Fv6+o50TykrWuvcht/S1w2me0pZ0Vo/
PfyWvh493VPKCn1c8JQ9pazQHwxP2VPKCn0n8ZQ9payk98PF8/aUspL+voTn
7SllJf37Lp63p5SV9HEUPG9PKSvp4/N43p5SVtLP++J5e0pZSZ9PhOftKWUl
fZ4qnrenlJX09Q943p5SVtLX1eF5e0pZSV+vjeft7Twr04s+J3hO3u3czxgP
z6k/GH0Z8Vw8hazQ7xfPwbud+xnj4bl9rvB7Bc/BGzsrjIPhuXj0M8bDG3rT
yUr6eV88b08pK+nzifC8PaWspM9TxfP2lLKSvv4Bz9tTykr6ujo8b08pK+nr
tfG8PaWspPcBwfP2lLKS3l8Kz9tTykp630I8b08pK+n9cPG8PaWspL8v4Xl7
SllJ/76L5+0pZSV9HAXP21PKSvr4PJ63p5SV9PO+eN6eUlbS5xPheXtKWUmf
p4rn7SllJX39A563p5SV9HV1eN6eUlbS12vjeXs7z8r0oo8LnpNHP2M8PI/+
YPSdxHPxFLJCP2M8B49+xnh4Pp8r/F7Bc/DGzgrjYHguHv2M8fCG3nSykn7e
F8/bU8pK+nwiPG9PKSvp81TxvD2lrKSvf8Dz9pSykr6uDs/bU8pK+nptPG9P
KSvpfUDwvD2lrKT3l8Lz9pSykt63EM/bU8pKej9cPG9PKSvp70t43p5SVtK/
7+J5e0pZSR9HwfP2lLKSPj6P5+0pZSX9vC+et6eUlfT5RHjenlJW0uep4nl7
SllJX/+A5+0pZSV9XR2et6eUlfT12nje3s6zMr3o44Ln5NHPGA/Poz8YfSfx
XDyFrNDPGM/Bo58xHp7P5wq/V/AcvLGzwjgYnotHP2M8vKE3naykn/fF8/aU
spI+nwjP21PKSvo8VTxvTykr6esf8Lw9paykr6vD8/aUspK+XhvP21PKSnof
EDxvTykr6f2l8Lw9payk9y3E8/aUspLeDxfP21PKSvr7Ep63p5SV9O+7eN6e
UlbSx1HwvD2lrKSPz+N5e0pZST/vi+ftKWUlfT4RnrenlJX0eap43p5SVtLX
P+B5e0pZSV9Xh+ftKWUlfb02nre386xML/q44Dl59DPGw/PoD0bfSTwXTyEr
9DPGc/DoZ4yH5/O5wu8VPAdv7KwwDobn4tHPGA9v6E0nK+nnffG8PaWspM8n
wvP2lLKSPk8Vz9tTykr6+gc8b08pK+nr6vC8PaWspK/XxvP2lLKS3gcEz9tT
ykp6fyk8b08pK+l9C/G8PaWspPfDxfP2lLJS83JW+1q56d9rczp2PLzZNp2s
1Py167eo9TkdOx7ebJtOVmqe57TCwxvbU8oKHp6vp/Rc8PCUPaXngoen7Ck9
Fzw8ZU/pueDhKXtKzwUPT9lTei54eMoeRVEURVEURVEURVEURVEURW3W/yfQ
XjY=
      "], {{0, 203.}, {203., 0}}, {0., 1.}, ColorFunction -> GrayLevel], 
     BoxForm`ImageTag[
     "Real32", ColorSpace -> Automatic, Interleaving -> None], Selectable -> 
     False], DefaultBaseStyle -> "ImageGraphics", 
    ImageSizeRaw -> {203., 203.}, PlotRange -> {{0, 203.}, {0, 203.}}, 
    ImageSize -> {300, 300}]},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.823838303224*^9, 3.8551505063988695`*^9, 
  3.8551505495396376`*^9, 3.8551526429841456`*^9},
 CellLabel->
  "Out[1051]=",ExpressionUUID->"2c8b2fcc-2b84-469b-b6f0-41ecacd7a09c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hsp", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ab", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"min", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IllusionFunction", "[", 
    RowBox[{"d", ",", "hsp", ",", "ab", ",", "min", ",", "max"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"d", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.81576757129*^9, 3.815767652711*^9}, {
  3.8157682857019997`*^9, 3.815768304854*^9}, {3.81576834279*^9, 
  3.81576835092*^9}, {3.815769112843*^9, 3.815769124532*^9}, {
  3.815769210197*^9, 3.8157692193*^9}, {3.8157695654309998`*^9, 
  3.815769571715*^9}, {3.815769649046*^9, 3.815769660539*^9}, {
  3.815770187509*^9, 3.8157702285179996`*^9}, {3.823839738534*^9, 
  3.823839742801*^9}},
 CellLabel->"In[870]:="],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
9Jeno//9TjeWsJ9LCU7hJyru//4fywdT4Q==
       "]]},
     Annotation[#, "Charting`Private`Tag$74224#1"]& ]}, {}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8157675875690002`*^9, 3.815767652885*^9}, {
   3.81576828613*^9, 3.8157683051610003`*^9}, 3.815768351328*^9, {
   3.815769113106*^9, 3.815769124856*^9}, {3.815769212955*^9, 
   3.815769219473*^9}, 3.815769572041*^9, 3.815769606085*^9, {
   3.815769649979*^9, 3.815769654234*^9}, {3.815770101519*^9, 
   3.815770123993*^9}, {3.815770188116*^9, 3.8157702286619997`*^9}, {
   3.815772987376*^9, 3.815772990979*^9}, 3.82383974363*^9},
 CellLabel->"Out[874]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hsp", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ab", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"min", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"iPlot", "=", 
  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"G", "[", 
      RowBox[{"d", ",", "hsp", ",", "ab", ",", "min", ",", "max"}], "]"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", "Thick"}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Cambria\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "1", ",", "0.2"}], "}"}]}], "]"}], 
         ",", "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Cambria\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"\"\<IllusionFunction(dist)\\n\\nhsp = \>\"", "<>", 
          RowBox[{"ToString", "[", "hsp", "]"}], "<>", "\"\<\\nab = \>\"", "<>", 
          RowBox[{"ToString", "[", "ab", "]"}], "<>", "\"\<\\nmax' = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"1", "-", "min"}], "]"}], "<>", "\"\<\\nmin' = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"1", "-", "max"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.75", ",", "0.5"}], "}"}]}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"500", ",", "500"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.815777378296*^9, 3.815777393317*^9}, {
  3.8157774359449997`*^9, 3.8157774943269997`*^9}, {3.815777670413*^9, 
  3.815777907227*^9}},
 CellLabel->"In[2677]:="],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {GrayLevel[0], Thickness[Large], Opacity[1.], LineBox[CompressedData["
1:eJwVjXs0FHgAhalRSik1yhQ607K7jYqNiqSb2Fhi8+ghwrGSpi167OmdZiPS
Y2QdO56NKNnZSGG1qBZHmyPNeCyjMS9jDPP4TW04ahs7/XHPd777x730uKTQ
AzNMTEyCjPnMgAMqwfPRXVvuJZjfzssTguKzLFlCc0OW4fxf/flCuN7mFD6m
+cJ2jk+wTaEQga/6HhXRwpGdvL6cUyzEnvjJpmxaPKLfCiKKS4UYdE73uUE7
CZ3r8EDTAyG41t9fyaSlYju/kxrcLATL/PFXV2k54A7VVz/RCLE3oqRK/7YM
AybuXoPBA7CYZkX52VeBc+6ifcajATiG6FQt12qQ8NT7spftG5zq9ADn/RNE
OdPTYzhvsLTGSmxq+gz7/ku+kG0tQp3cp+P15mas7A28qi8XoZlZtDxC0wqu
hddc1bZBjH/pteDBkReoM23tlA4OYsYUb+Fyx3YsWhchzb8lxobp2Lqwyg64
5FhHZvtK0JHq1tnGeA252e6MQoMEK7LUUxU6Pnbq2f1OTCnUkxJxr0sXRFvj
DyV2S1E21tBuebMb+XHniqMDZbC0KycKRQ/mafSTsjYZrh+qTeA6/IPYza48
skWOia08RWJKH/gvTWqpbXKcXNdas6SlH16SmNgk/yFIKluvCegDeJe0cape
OISPzJ6CVWffQBMvesE/rICT92xDQoMIe4/49rMnFPC7Qz9YvVQMRQKR6W4O
45RdzEpZlATBR81UQfZKrNbssugLkuJ+k0fEep4SixfozVs/SNHjp5hV6TMC
yrOCqi8KZbhzM+GDlD+Cw24NwjmBcoj/tZLoD6rA+y6O+3RCjvfyNGbKlArj
6mULlblDqHViNTlfHEVtmN/MHF8FQsvfFdnNHUOKf9rtGqUCS9KjRKkZY6AP
BvSXpg2DQW32tjZRY9PG1BzaOiWCvtkVlntejSj711Om3Upsr3ZKzlarMd5+
Q57MGgG1YvY+s2gNOJTok6EOKiTvXO7u3aLBYnHtnRmtKmSSABcGXQuzC6xw
j2OjCPuWqpjP0sKkIrpKvmgMvfUlBYYeLY7nV91Y1DyGnW2bfqcwdGhyyjC3
OqpG7t21T8tO6WAVcHz1z5Ya8Dwj+aYNOojW8LvPNGrwZFJ4ocWgw8NiOCii
tfilMIbp50Gwv2qDlZ1Bi4E1bBw+SnAprYQl+k2HloqUEk4pwQOVXYHlDoJt
be5d3gKCjKK0WHEwQcXZS3FmXQTxoVrHyhACvWcI72+j2zY2PgzaQ6DcKkkI
7iHIZEe2XY8jcOYo03f3ESRuyHs79wzBy+eJlyMGCVamUv1n3yPIc2XoGKME
Bvfz8/vuE9gIFHXDRhdqh7ru8Qjm6R5u4o4RZO15vH97NYFLeOcJqoZgmhF6
Iq2RwHFjaOWUjkAkYBfP7CbommW7+4/3BPVXJn/o7iUIvBojPDJOkOMZs6q0
nwApEzYOE8b+7tqabWICQkl6xZ4k+PP0q5cs4y+3vWF+/AeC3DXr2SHGH5l/
x082HwmOyQvD6YQgNYOf32H0r3f8KHlu/MkMpti6fSKgmPaUZRl3wgSRp0eM
Lq31ZMYad7wtJ2/lGwgamaXOLsb+lmE0MWia4NcVFuPTRp7N8//0mf8DKy2L
uA==
       "]]},
     Annotation[#, "Charting`Private`Tag$62018#1"]& ]}, {}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    GrayLevel[0], FontFamily -> "Cambria", FontSize -> 20, 
    InsetBox[
     FormBox[
     "\"IllusionFunction(dist)\\n\\nhsp = 0.5\\nab = 5\\nmax' = 1\\nmin' = \
0.4\"", TraditionalForm], {0.75, 0.5}]},
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, {}}, {{{0., 
       FormBox["0.`", TraditionalForm]}, {0.2, 
       FormBox["0.2`", TraditionalForm]}, {0.4, 
       FormBox["0.4`", TraditionalForm]}, {0.6000000000000001, 
       FormBox["0.6000000000000001`", TraditionalForm]}, {0.8, 
       FormBox["0.8`", TraditionalForm]}, {1., 
       FormBox["1.`", TraditionalForm]}}, {}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->{500, 500},
  LabelStyle->{
    GrayLevel[0], FontFamily -> "Cambria", FontSize -> 14},
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8157774946730003`*^9, {3.815777673045*^9, 3.815777705179*^9}, {
   3.815777788182*^9, 3.81577779229*^9}, {3.815777850217*^9, 
   3.815777907848*^9}},
 CellLabel->
  "Out[2681]=",ExpressionUUID->"96ee8326-df02-48a8-b88f-221ce9a8e21f"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["isoluminant", "Subsection",
 CellChangeTimes->{
  3.8019912783929996`*^9, {3.815403561343*^9, 3.815403572644*^9}, {
   3.855148617611225*^9, 3.855148621133293*^9}, {3.855148697739156*^9, 
   3.855148698316842*^9}, {3.8551533342981935`*^9, 
   3.8551533423637047`*^9}},ExpressionUUID->"c71b79eb-7ef0-47d7-935c-\
b7f0dd8e9bf3"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["kigy\[OAcute]z\[OAcute]",
 IgnoreSpellCheck->True]], "Subsubsection",
 CellChangeTimes->{
  3.8019912783929996`*^9, {3.815403561343*^9, 3.815403572644*^9}, {
   3.855148617611225*^9, 3.855148621133293*^9}, {3.855148697739156*^9, 
   3.855148698316842*^9}, {3.8551533342981935`*^9, 3.8551533423637047`*^9}, {
   3.8551534375687537`*^9, 
   3.8551534451374474`*^9}},ExpressionUUID->"0e343aca-3fcd-4ca1-8069-\
1be9c6c1e9b7"],

Cell[BoxData[
 RowBox[{"isoluminantGrid", "=", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Image", "[", 
       RowBox[{"GenerateGrid", "[", 
        RowBox[{"7", ",", "500", ",", 
         RowBox[{"1", "/", "3"}], ",", "0", ",", 
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", "Black", ",", "True",
          ",", "True"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Image", "[", 
       RowBox[{"GenerateGrid", "[", 
        RowBox[{"7", ",", "500", ",", 
         RowBox[{"1", "/", "3"}], ",", "0.4", ",", 
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", "Black", ",", 
         "False", ",", "True"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
     ",", 
    RowBox[{"Antialiasing", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8551535802516427`*^9, 3.855153583253315*^9}, {
  3.8551537126231384`*^9, 3.8551537150239706`*^9}, {3.855153995316568*^9, 
  3.8551540200607924`*^9}, {3.8551542910226183`*^9, 3.8551543028993635`*^9}, {
  3.855154334035493*^9, 3.855154341299152*^9}, {3.8551554526617737`*^9, 
  3.855155498775758*^9}, {3.855155612869375*^9, 3.8551556767018547`*^9}, {
  3.8551557326614404`*^9, 
  3.855155738842926*^9}},ExpressionUUID->"e2b9171b-59ed-42d3-93f9-\
a27506e77247"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "243", ",", "33"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"74", ",", "66", ",", "175"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"197", ",", "158", ",", "81"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"138", ",", "63", ",", "38"}], "}"}], "/", "255"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.855154733978944*^9, 3.8551547660832376`*^9}, {
  3.855156448694719*^9, 3.8551565273843684`*^9}, {3.8551566746066885`*^9, 
  3.855156703673705*^9}, {3.855158295831498*^9, 
  3.85515831019619*^9}},ExpressionUUID->"b2f8aa3d-4632-4760-98df-\
3a1347f784dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "249", ",", "17"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"63", ",", "81", ",", "68"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"172", ",", "155", ",", "79"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"24", ",", "60", ",", "199"}], "}"}], "/", "255"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.855154733978944*^9, 3.8551547660832376`*^9}, {
  3.855156448694719*^9, 3.8551565273843684`*^9}, {3.8551566746066885`*^9, 
  3.855156703673705*^9}, {3.855158299191761*^9, 3.855158365529114*^9}},
 CellLabel->
  "In[1411]:=",ExpressionUUID->"96aca63b-b4a7-4559-9a1a-8db484f6ef39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"replacementRules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "->", "b1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "->", "s1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0"}], "}"}], "->", "s2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], "->", "b2"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<\\\\iso2\\\\base.png\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"GenerateGrid", "[", 
          RowBox[{"7", ",", "500", ",", 
           RowBox[{"1", "/", "3"}], ",", "0", ",", 
           RowBox[{"Pi", "/", "2"}], ",", "0", ",", 
           RowBox[{"Pi", "/", "2"}], ",", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", "Black", ",", 
           "True", ",", "True"}], "]"}], ",", 
         RowBox[{"Antialiasing", "\[Rule]", "False"}]}], "]"}]}], "]"}], ";", 
     "\n", 
     RowBox[{"Export", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<\\\\iso2\\\\overlay.png\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"GenerateGrid", "[", 
          RowBox[{"7", ",", "500", ",", 
           RowBox[{"1", "/", "3"}], ",", "s", ",", 
           RowBox[{"Pi", "/", "2"}], ",", "0", ",", 
           RowBox[{"Pi", "/", "2"}], ",", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", "Black", ",", 
           "False", ",", "True"}], "]"}], ",", 
         RowBox[{"Antialiasing", "\[Rule]", "False"}]}], "]"}]}], "]"}], ";", 
     "\n", 
     RowBox[{"iso", "=", 
      RowBox[{"ImageAdd", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<\\\\iso2\\\\base.png\>\""}], "]"}], ",", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<\\\\iso2\\\\overlay.png\>\""}], "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<\\\\iso2\\\\overlaid_\>\"", "<>", 
        RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\<.png\>\""}], ",", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"ImageData", "[", "iso", "]"}], "]"}], "/.", 
          "replacementRules"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "0.4", ",", "0.05"}], "}"}]}], "]"}], ";"}]}],\
 "Input",
 CellChangeTimes->{{3.855156605698188*^9, 3.8551566314073486`*^9}, {
   3.8551567240175395`*^9, 3.8551567749105434`*^9}, 3.8551583764235725`*^9, {
   3.8551584591602573`*^9, 3.8551584624208755`*^9}, {3.8551585417272224`*^9, 
   3.855158545262244*^9}},
 CellLabel->
  "In[1420]:=",ExpressionUUID->"6f3b5c31-4c67-4d46-a134-67b660929225"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 508},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
WindowStatusArea->"grid_generator.nb last backed up to grid_generator.nb~ on \
Wed 6 Oct 2021 at 4:54:02 PM",
SpellingDictionaries->{"CorrectWords"->{"isoluminant"}},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1f484004-2485-45c1-9226-b8d60c79a10f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 291, 5, 43, "Subsection",ExpressionUUID->"fe33b749-774f-42bb-9b63-3807fe737bd5"],
Cell[CellGroupData[{
Cell[896, 31, 275, 5, 36, "Subsubsection",ExpressionUUID->"2c7764a2-2e54-45e1-a291-d0a16901e0ee"],
Cell[1174, 38, 503, 13, 36, "Input",ExpressionUUID->"3c9b2551-9859-4812-ad09-1522d22cf617",
 InitializationCell->True],
Cell[1680, 53, 850, 23, 145, "Input",ExpressionUUID->"675a9eb6-4f05-4589-acea-281b1c4d1e1e"],
Cell[2533, 78, 19162, 490, 896, "Input",ExpressionUUID->"d4f88b7e-b83d-47be-a3d0-7a3bffe5ce87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21732, 573, 271, 5, 36, "Subsubsection",ExpressionUUID->"4fe25e58-6696-4aa0-b544-b4009937a4da"],
Cell[22006, 580, 2521, 76, 115, "Input",ExpressionUUID->"d9bf4506-c9e0-4701-aa7b-e613d25043b1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[24552, 660, 141, 3, 22, "Input",ExpressionUUID->"d246b27b-7631-4a3e-a968-657bc653574e"],
Cell[24696, 665, 132, 2, 25, "Output",ExpressionUUID->"7d095849-5865-4bdd-b450-291472df082e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24865, 672, 19967, 481, 1342, "Input",ExpressionUUID->"6d064f03-63bb-47e8-b70b-e8e9e85dbb43"],
Cell[44835, 1155, 20034, 373, 255, "Output",ExpressionUUID->"2c8b2fcc-2b84-469b-b6f0-41ecacd7a09c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64906, 1533, 1302, 32, 130, "Input",ExpressionUUID->"66503275-a2df-44e8-9fd1-20e00ddd975a"],
Cell[66211, 1567, 10511, 190, 298, "Output",ExpressionUUID->"bbcc7174-9b69-4d02-97cb-bfff4ae23628"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76759, 1762, 2943, 74, 236, "Input",ExpressionUUID->"c0bb1fe3-e3cc-4482-b406-45574aecf514"],
Cell[79705, 1838, 3973, 89, 413, "Output",ExpressionUUID->"96ee8326-df02-48a8-b88f-221ce9a8e21f"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83739, 1934, 331, 6, 43, "Subsection",ExpressionUUID->"c71b79eb-7ef0-47d7-935c-b7f0dd8e9bf3"],
Cell[CellGroupData[{
Cell[84095, 1944, 445, 8, 36, "Subsubsection",ExpressionUUID->"0e343aca-3fcd-4ca1-8069-1be9c6c1e9b7"],
Cell[84543, 1954, 1476, 31, 69, "Input",ExpressionUUID->"e2b9171b-59ed-42d3-93f9-a27506e77247"],
Cell[86022, 1987, 928, 29, 69, "Input",ExpressionUUID->"b2f8aa3d-4632-4760-98df-3a1347f784dc"],
Cell[86953, 2018, 952, 29, 69, "Input",ExpressionUUID->"96aca63b-b4a7-4559-9a1a-8db484f6ef39"],
Cell[87908, 2049, 3697, 94, 252, InheritFromParent,ExpressionUUID->"6f3b5c31-4c67-4d46-a134-67b660929225"]
}, Open  ]]
}, Open  ]]
}
]
*)

